logo = """                                         `                                                                                                                             ``           
               ./:------...`           `-/      ..........`       .......   `.....           `-:::-.`      `.----.`     .......     ......`.......           .----.`   ..           
               `+yNNNdyssyhddy/.     `/hNN-     /yNNNdyydmdo.     :yNNNy-  `ommhs/`        .ymmyssdmy`  `/sdho++oydy+.  :smmmo:     :smmo-`/ymmmo/        `/hds+oymh-               
                 .MMM:    `:hMMms`   `hMMMd`     .NMMo``.yMMm.     :MMM-  .yNd/.          `hMM+`  .sy` /dMm/`    `/mMmo` .NMM.       `dh`   /MMd`         +MMo`` `/d:               
                 `MMN.      `yMMMs   :NhNMMs`    `NMMo   +MMM-     :MMM.`+mm+`    ```     `dMMd/`  `` :NMM/        -dMMy``NMM.       `hy    :MMd`         +MMm/.   `                
        `````````.MMM. ``.```:NMMN-.-dh:sMMN/```.-NMMy//omMms.``   :MMMhdMd:```  ``` `     -dNMMmy+-.`yMMN-````````.oMMM:-NMM-```.```.dy.```/MMd.````  ```.smMMmho:...``````        
         ````````.NMM- ```` `.mMMN..hMhyyNMMm-``..NMMdsmMMm:```    :MMMsdMNy:``.          ` `:ohNMMNo.sMMN-`````````+MMM/.NMM-`````` .my`  `/MMd`` `    ````.+ymMMNy.````           
                 `mMM.       -NMN+`sN+:::/NMMy`  `NMMs`-hMMh-      :MMM-`+mMNs..          ./   `-sMMN--mMMo`       `hMMh``mMM:       .No    /MMd`      `  :`   `/mMM/               
                 `mMM:    `./mMd/`+Ms     /MMM+  .NMMs  `sNMm/`    :MMM-  .sNMmo.        `yNo.   `mMN- :mMMo.     .sMNy.  oNMd-     .ym-    /MMm`     -h:+Ns.    +MM+               
               `+sNMMmsooshdds/./sNN/`    -mNNmo/sNNNd:   :ymmy:` -sNNNo`  `oNNNdo-`     `/mNms//smy-   .+dmho++oshds:`    /hNmhoooyhs-   ./hNNNs+//+odN/-yNds//odmo`               
               `:::::::::--.`  `--:--`    .------------     `.--` .-----`   .------.       .:////:.       `.-:///:.`         .:///:-`     .-------------`  -:///:-`               
\n""" + ' '* 80 + 'T E X T   R P G \n\n'
bonfire = """                                                                                O          
                                                                                '       
                                                                                [         
                                                                                }         
                                                                                |         
                                                                            =========    (                     
                                                                               |#|      (                    
                                                                               |#|     ((/                   
                                                                               |#|((((((                   
                                                                               |((/((//(((                   
                                                                            ,(((((((*((((                   
                                                                            ((((/((((**(((                   
                                                                        .   ((((((/(****((((((                
                                                                        ((  (((((*******(((((((  /            
                                                                        (((((((*****.*****((((((((/           
                                                                        /(((*((*****....****(((((((           
                                                                        (((**/*****......*****(((           """

you_died = """     .'......................................................................................................................................................................'.     
    ..'......................................................................................................................................................................'.     
                                         ...     ...   ... ...   ....     ..               ........        ....     ...........  .......                                            
                                         ...     ..   ..     ..  ....     ..                ...  ....       ...      ...     ..  ...  .....                                         
                                          ...   ..   ..       ..  ..      ..                ..      ...     ..       ..          ..      ...                                        
                                           ... ..   ...       ... ..      ..                ..      ...     ..       ..          ...      ..                                        
                                            ....    ..         .. ..      ..                ..       ..     ..       .........   ...      ...                                       
                                             ..     ...        .. ..      ..                ..       ..     ..       ...    ..   ..       ...                                       
                                             ..     ...       ... ..      ..                ..      ...     ..       ..          ..       ..                                        
                                             ..      ..       ..  ...     ..                ..     ...      ..       ..       .. ..      ...                                        
                                            ....      ...   ...    ...   ..                ..........      ....     ............ .........                                          
                                            ....        .....       ....                    ......         ....     ...........  .......                                            
     ...                                                                                                                                                                     ..     
     .'......................................................................................................................................................................''.  """

victory = """                ,,,,     ,,, ,,,    ,;;;,, ,,,,,,,,,,   ,;;;,    ,,,,,    ,,      ,,                   ,;;;,  ,,,    ,,,  ,,, ,,,,,,,,,,,     ,,,,,,,,,,,,,,,,,,
                ,cxl,   ,lo;,ld: ,:lc::codlllclxoclo: :lcccccc;  cxo:ldc,,cxo,   :dc,        ,l:    ,clc::cod::dl,   ,od; cdc ;dxccl:,cxl,   ,lo;,lxl:lc,cxo:cloo:,
                 ,xx;   ;oc  ok: ld:    ,cc,, :ko  ,,lxc,   ,ld: :ko ,dO: ,lkl  ;ol,         :kd,  ,oo;    ;l;:kl     dk;.ckl ,dx; ,, ,xx;   ;oc  lkc.,, ckl   ;lkd,
                  :ko   cl,  ok::xc           :ko   :ko      ,ox;;kd, lk:   lxc;oc          ;lldl  lx;      , :ko,,,,;dk;.ckl ,dk; ,,  :ko   cl,  lOc ,, ckl     cOo
                  ,dk: :l;   ok:lk:           :ko   cOl       ckc;kx:coc     lkxc,          co:ox;,dx,        :Oxccccckk;.cOl ,dOlco:  ,dk: :l;   lOdcoc ckl     ;kx,
                   ;kd;lc    ok:lOc           :ko   cOo       ckc;kklxkc     ,xk;         .;oo:lko,dO:        :kl     dk;.cOl ,dk; ;,   :kd;lc    lOc ,; ckl     ;xd,
                    lOxl,    ok:;kk:     ,,   :ko   ,ok:     ,dd,;ko ,lkc    ,dx;         ,lo,  lkc:Ox;     ;,:kl     dk;.cOl ,dk;       lOxl,    lOc    ckl ,  ,lx:
                    ,dk;    ,dOc ;dkoc;;:oc   cOd,   ,col:;;col; cOd, ,cxd:, ;xk:        :dxc   ,xk:cxxl:;;co:cOo,   ,xk: lOo ,x0l;c:,   ,dk;     l0d:::,l0d:;:clo:
                     ;;,    ,cl:, ,;clc:c:,   ;cc,     ,:ccc:;   ;cc,   ;lc; ,cc;       ,:cc;   ,:c:,,:lc::c:,;lc,   ,:c;,:l:,,:lccc;     ;;     ,:llcc:,:llcccc;,"""

asylum_demon = """
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0o:cdx;;lo0WWMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWO::o,,;,;'.':dONMWMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0c,..,,..'ol'..:cl0MMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKXMMMMMMMMMMMMMMMMXl.';..;c..':lc:','.xMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWMMWMMMMMMMMMMWMMMMMMNooXMMMWWXKNMMMMMMXx,.'kO;....'do;cxc.''lXWMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNWMMMMMWX0KNMMMMMMMWXKxlOMMMXOkoo0NMMMWk, .,.,;'...',xXo'co,,',0WMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMXdoKNNWMWOo;:KMMMMMXdlldOXNX0xOl;xO0NWKc..;,'.  ...:l;';;.'cl:,,oXMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0ccddxXWO,,dXWXXKkl;,oKOllollxOo. .':,...'  ....'..':lcol,''':dcOMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOl;:c;:o' c0xc'''.';.:l;'';:cdOo.     ..   .,,.  .,'.cc.....,',xNMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOc;...''  ... ...,c,'..cc,coo:.       ....  ..'..:;    .,:lodKWMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMKk0x'   .. .. ....,,....,',lc.     .   ..   . .'. ..'ldx0NWWMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOdc. .    .. ..... .  ...   ,:.               .,lkKXWMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWd.   .   ..   ......      .lc                .lXMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMO.    ..  ...'''..        .:dd,.. ..            cXMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN:   .';'.   .''......     .:x00x; .;.  ':::c'  ..dWMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMk. . ....     ...'...       .;:oxo,.,,',lKWNNk.,Oc;0MMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMWO;.';'.   .........        ..    ':cc:;,..;KMMWddNO:kMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMWk;....,.      .';;'.     ..,;,..     .',;c:..cXMMNNMNOKMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMWo....'.   'c.   ...  ..  .,,.....   .. ...,;''kMMMMMMMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMXko,. 'c;. ;0Xc    ....;cclc;.......  .,:c,. ..:XMMMMMMMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMXkkd,..'l:;ll:'    ....,'.',;:cc::;'.   .clcldllKMMMMMMMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMWKkxl',dc.     .;l:.:kxololcoo;;;.  .   .loollxk0WMMMMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMK:;ol;.    ..,'..:cc;:odl,',.  ... ..    .',;coKMMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMNk;......  ...',;',cccoxdc;,...  ..,..      .';,.,kWMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMWNKd,.:xOxc.  ..',,,:,.:c;cc;cl...   .;clcc,.  ....;;.cNMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMNOlc::,..l0WMW0l,      .':,.',',cl:....    'cdxdl,.oKKx'...oWMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMXl.     .dWWMMMNl         ..     ......     ..;o0Kk;oWMWd.'xNMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMNXOc,,. ,c,:KMMMMWO, ...                      .';:xO0Ko:ONM0o0WMMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMWKkoc:;..lx::0WMMMWx. 'c:.       ...';:,....,;co:...;c;:ll,dWMWWWWMMMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMWXOdc,'.,l:dNMMMMMNc .xk:.      .dKXNWMWXKKXWMWMWK0x,   ...lWMMXddKWMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMN0OOxodOdxNMMMMMMN: ,l;'.      'OMMMMMMMMMMMMMMMMMMXd'...':kXXkooxOXNWWMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMWNWMWNWMMMMMMMNd'....      :0WMMMMMMMMMMMMMMMMMMMMXx'.;lc;d0XWWWWWMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0kl.     ,0MMMMMMMMMMMMMMMMMWWNNXWNo;;cd:'cxkKWMMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXo;;. ...  .:xdlooodddoooollc::;,'',,'::.'l,..;dKWMMMMMMMMMMMMMMMMM
                                    MMMMMMMMMMMMMMMMWWWNNNNKKK00Oxool;  .  .. ..  .               ..   ..  ....''..,l0WMMMMMMMMMMMMMMMMM"""
                                    
from os import system, name 
from random import randint

global_loot = {
    #all possible inventory objects dict
    'fist' : {
        'name': 'fist',
        'class': 'weapon',
        'power': 24,
        'prot': 17,
        'distance': 0.5,
        'info': 'convenient to use when you have no weapons',
    },
    'prison key' : {
        'name': 'prison room key',
        'class': 'key',
        'info': 'key that opens your prison room you have been locked in',
    },
    'asylum arena key': {
        'name': 'asylum arena key',
        'class': 'key',
        'info': 'key which can be taken from asylum demon',
    },
    'balders knight sword' : {
        'class': 'weapon',
        'name': 'balders knight weapon',
        'power': 75,
        'prot': 23,
        'distance': 0.8,
        'info': 'sword taken from balder undead knight'
    },
    'balders knight armor' : {
        'class': 'armor',
        'name': 'balders knight armor',
        'prot': 45,
        'info': 'armor taken from balder undead knight',
    },
    'wooden magic stick' : {
        'class': 'weapon',
        'name': 'wooden magic stick',
        'power': 30,
        'prot': 13,
        'distance': 2,
        'info': 'wooden stick which mostly use roving magicians'
    },
    "poor magician's dress" : {
        'class': 'armor',
        'name': "poor magician's dress",
        'prot': 21,
        'info': 'dress with sewn holes'
    },
    'underpants' : {
        'class': 'armor',
        'name': "underpants",
        'prot': 12,
        'info': "doesn't protect anything but the most important"
    },
    'broken sword':{
        'class' : 'weapon',
        'name'  : 'broken rusty sword',
        'prot'  : 9,
        'power' : 45,
        'distance' : 0.65,
        'info'  : 'broken undeads sword rusted by time'
    },
    'tower shield':{
        'class' : 'weapon',
        'name'  : 'tower shield',
        'prot'  : 43,
        'power' : 23,
        'distance' : 0.5,
        'info'  : 'black tower shield mostly used by undead soldiers'
    },
    'undead soldiers armor':{
        'class' : 'armor',
        'name'  : 'undead soldier`s armor',
        'prot'  : 40,
        'info'  : 'armor set taken from neutralized undead'
    },
    'astorian knights shield': {
        'class' : 'weapon',
        'name'  : 'tower shield',
        'prot'  : 43,
        'power' : 23,
        'distance' : 0.5,
        'info'  : 'black tower shield mostly used by undead soldiers'
    }
}
classes = [
    # used to create a hero in newgame start
    {
        'name'      : '',
        'class'     : 'knight',
        'info'      : 'very powerfull',
        'start-inv' : 'knight sword and armor',
        'health'    : 100,
        'power'     : 100,
        'luck'      : 0.8,
        'sword'     : global_loot['balders knight sword'],
        'armor'     : global_loot['balders knight armor'],
        'shield'    : global_loot['fist'],
        'inventory' : [
            global_loot['underpants'],
            global_loot['balders knight sword'],
            global_loot['balders knight armor'],
        ],  
    }, {
        'name'      : '',
        'class'     : 'magician',
        'info'      : 'long distance fight',
        'start-inv' : 'magic stick and dress',
        'health'    : 50,
        'power'     : 100,
        'luck'      : 1,
        'sword'     : global_loot['wooden magic stick'],
        'armor'     : global_loot["poor magician's dress"],
        'shield'    : global_loot['fist'],
        'inventory' : [
            global_loot['underpants'],
            global_loot['wooden magic stick'],
            global_loot["poor magician's dress"],
        ],  
    }, {
        'name'      : '',
        'class'     : 'poor',
        'info'      : 'ultra lucky',
        'start-inv' : 'nothing',
        'health'    : 120,
        'power'     : 100,
        'luck'      : 1.6,
        'sword'     : global_loot['fist'],
        'armor'     : global_loot['underpants'],
        'shield'    : global_loot['fist'],
        'inventory' : [
            global_loot['underpants'],
        ],  
    }
]

hero = {
    'name'      : 'Jordan',
    'class'     : 'knight',
    'info'      : 'very powerfull',
    'start-inv' : 'knight sword and armor',
    'health'    : 100,
    'init_heal' : 100,
    'estus'     : None,
    'power'     : 100,
    'luck'      : 0.8,
    'sword'     : global_loot['balders knight sword'],
    'armor'     : global_loot['balders knight armor'],
    'shield'    : global_loot['fist'],
    'inventory' : [
        global_loot['underpants'],
        global_loot['balders knight sword'],
        global_loot['balders knight armor'],
    ],  
}

enemies = {
    'room corridor': {}, 
    'asylum demon': { 
        'name': 'asylum demon',
        'health': 425,
        'init_heal' : 425,
    },
    'corridor archer': {
        'name': 'corridor archer',
        'health': 30,
        'init_heal' : 30,
    },
    'steel ball undead': {
        'name': 'corridor archer',
        'health': 50,
        'init_heal' : 50,
    },
    'third floor undeads': {
        'name': 'third floor undeads',
        'health': 80,
        'init_heal' : 80,
    }
}
opened_doors = []
alive_enemies = [el for el in enemies.keys()]
current_map = 'prison'
curr_location = None
prev_location = None
last_fire = 'prison room'

def enemy_rebirth():
    global hero, alive_enemies, enemies, last_fire
    clear()
    last_fire = curr_location
    if hero['estus']:
        hero['estus'] = 1
    hero['health'] = hero['init_heal']
    alive_enemies = [el for el in enemies.keys()]
    line = "Y O U   H A V E   T A K E N   A   R E S T"
    print('\n' * 10)
    print('__' * 87 + '\n')
    print(' ' * (87 - len(line) // 2) + line + '\n')
    line = 'ENEMIES RESURRECT AFTER TAKING REST'
    print(' ' * (87 - len(line) // 2) + line )
    print('__' * 87 + '\n')
    enter_to_continue()

def enemy_stat(enemy):
    name_low = enemy['name']
    name = ''
    for char in name_low:
        name += char + ' '

    print('\n' + " " * 68 + " " * (19 - len(name)//2) + name.upper())
    health_bar = '■' * int(42 * enemy['health'] / enemy['init_heal']) + ' ' * int(42 - 42 * enemy['health'] / enemy['init_heal'])
    print('\n' + " "*58 + "-------|" + health_bar.upper() + "|------- \n")

def boss_defeat():
    clear()
    print('\n' * 7)
    print(victory)
    enter_to_continue()

def drop(*items):
    """random drop after killing an enemy

    hero dict and items dicts which can be dropped

    {'name': 'broken sword', 'poss': 25}

    the less possibility the more chance to get the object
    """
    global hero
    for item in items:
        name = item['name']
        obj = global_loot[name]
        if obj in hero['inventory']:    # in case if the drop object is already in inventory
            continue
        possibility = item['poss']
        luck = hero['luck']
        if randint(0,100) * luck >= possibility:
            hero['inventory'].append(obj)
            message('you`ve got ' + name + '!')
    return hero


def move(enemy, poss, type):
    """enemy_obj, possibility, type(attack or dodge).

    possibility is here for poss. of taking damage.

    the less possib. the more chance to succeed."""
    global hero
    sword = hero['sword']
    num = randint(1,100) * hero['luck']
    if type == 'attack' or type == 'Attack':
        num = num * sword['distance']
        if num >= poss:
            num = int(num)
            enemy['health'] -= num
            return f"This attack was successfull, you have taken {num} from enemy's health"
        else:
            armor = hero['armor']
            damage = (100 - armor['prot']) / 100
            num = int(damage * num)
            hero['health'] -= num
            return f"That wasn't a successfull move, you are taking {num} amounts of dammage"
    else:
        shield = hero['shield']
        if shield == global_loot['fist']:
            # hero can protect itself with weapon instad of fist
            shield = sword
            
        num = num * shield['prot'] / 50
        if num >= poss:
            num = num * sword['distance']
            num = int(num)
            enemy['health'] -= num
            return f"your dodge was successfull, you have taken {num} from enemy's health"
        else:
            num = num * (100 - shield['prot']) / 100
            num = int(num)
            hero['health'] -= num
            return f"You couldn't successfully dodge, you are taking {num} amounts of dammage"

def hero_creator():
    global hero
    clear()
    hero_obj = {}
    location_print('select your class')
    params = ['class', 'health', 'luck', 'info']
    length = [15, 10, 10, 35]
    table(params, length, classes)
    user_choice = input("\n" + " " * 83 + ">| ")
    if user_choice == '0':
        return main_menu()
    elif user_choice not in [str(index + 1) for index in range(len(classes))]:
        alert('wrong input')
        return hero_creator()

    hero_obj = classes[int(user_choice) - 1]
    hero_obj['init_heal'] = hero_obj['health']
    hero_obj['estus'] = None
    location_print('enter your name')
    hero_name = input("\n" + " " * 67 + ">| ")
    if len(hero_name) > 15:
        new_name = ''
        for i in range(13):
            new_name += hero_name[i]
        hero_name = new_name + '...'
    hero_obj['name'] = hero_name
    hero = hero_obj

def clear(): 

    # for windows 
    if name == 'nt': 
        system('cls') 

    # for mac and linux(here, os.name is 'posix') 
    else: 
        system('clear') 

def enter_to_continue():
    print(' ' * 66 + '-' * 42 + '\n' + " " * 76 + "press Enter to continue")
    input()
    clear() # clearing the console

def show_status():
    global hero
    # one line display of hero status
    health_bar = '■ ' * int(hero['health'] // 10) + '□ ' * int((hero['init_heal'] - hero['health']) // 10)
    if hero['health'] % 10 >= 5:
        health_bar = '■ ' + health_bar
    elif hero['health'] % 10 >=1:
        health_bar = health_bar + '□ '

    health_bar =  '+ ' + health_bar
    #sword and armor
    shield = hero['shield']
    if hero['shield'] == global_loot['fist']:
        shield = hero['sword']
    tools = ' X ' + str(hero['sword']['power']) + ' # ' + str(hero['armor']['prot']) + ' [] ' + str(shield['prot'])
    if hero['estus'] != None:
        tools += ' * ' + str(hero['estus'])
    print(' ' * 47 + '~ ' + hero['name'] + '  ' + health_bar + ' ' * (76 - len(hero['name'] + health_bar + tools)) + tools)

def situation(text):
    print(' ' * 47 + '-' * 80 + '\n') # newline
    arr = text.split()
    line = ''
    for word in arr:
        if len(line + word) <= 76:
            line += word + " "
        else:
            print(" " * 45 + '|   ' + line + ' ' * (77 - len(line)) +'  |')
            line = word + " "
    print(" "*45 + '|   ' + line + ' ' * (77 - len(line)) +'  |')
    print('\n' + ' ' * 47 + '-' * 80)

def message(msg):
    clear()
    text = ''
    for char in msg:
        text += char + ' '
    print('\n' * 10)
    print(' ' * 47 + '-' * 80 + '\n') 
    line = " "*(38 - len(text) // 2) + text.upper() + " "*(38 - len(text) // 2 + len(text) % 2)
    print(" "*45 + '|   ' + line + ' ' * (77 - len(line)) +'  |')
    print('\n' + ' ' * 47 + '-' * 80)     
    enter_to_continue()

def location_print(name):
    long_name = ''
    for char in name:
        long_name += char + ' '
    print('\n' + " "*58 + "-------|  " + " "*(19 - len(long_name)//2) + long_name.upper() + " "*(19 - len(long_name)//2) + "  |------- \n")

def alert(message):
    clear()
    text = ''
    for char in message:   #making spaces between characters in sentence
        text += char + ' '
    print('\n' * 10)
    print(" "*58 + ">> !! >> " + "█" + " "*(19 - len(text)//2) + text.upper() + " "*(19 - len(text)//2) + "█" + " << !! << ")
    print(" "*68 + "_"*39)
    enter_to_continue()

def table(params, percentage, arr):  
    """ params = ['name', 'info'], 
    
    params length percentage = [25, 40], 
    
    actual array = [{'name': 'prison room key', 'info': 'opens your prison room'}] """
    line = ''
    left_space_amount = 62
    underline = "_"
    for i in range(len(percentage)):    # printing header line
        space = round(75 * percentage[i]/100)
        left_space_amount -= (space - len(params[i]))//2
        line += params[i].upper() + " " * (space - len(params[i])) + " | "
        underline += '_' * (space + 3)
    line = ' ' * (left_space_amount + 8) + "| " + line
    underline = ' ' * (left_space_amount + 8) + underline
    print(line + "\n" + underline + "\n")
    for index in range(len(arr)):     #printing body
        obj = arr[index]
        line = ' ' * left_space_amount + f"<| {index + 1} |> " + '| '
        for i in range(len(percentage)):
            param = params[i]
            space = round(75 * percentage[i]/100)
            line += str(obj[param]) + " " * (space - len(str(obj[param]))) + " | "
        print(line + f"<| { index + 1 } |>" +"\n" + underline + "\n")

    print("\n" + " "*58 + "<| 0 |> " + "-" + " "*(20 - len('EXIT')//2) + 'EXIT' + " "*(20 - len('exit')//2) + "-" + " <| 0 |> ")
    print(" "*67 + "_"*40 + '\n')

#locations functions

def tool_change(tool):
    global hero
    new_arr = []
    params = []
    length = []
    clear()
    show_status()
    situation(f"Chose the {tool} you want to change to")
    for el in hero['inventory']:
        if (tool == 'shield' or tool == 'sword') and el['class'] == 'weapon':
            new_arr.append(el)
        elif tool == 'armor' and el['class'] == 'armor':
            new_arr.append(el)

    if tool == 'shield' or tool == 'sword':
        params = ['i', 'name', 'prot', 'power', 'info']
        length = [5, 30, 10, 10, 70]
        for el in new_arr:
            if el['power'] >= el['prot']:
                # if its a sword
                el['i'] = ' X '
            else:
                # if its a shield
                el['i'] = ' [] '
    else:
        params = ['i', 'name', 'prot', 'info']
        length = [5, 30, 10, 70]
        for el in new_arr:
            el['i'] = ' # '

    table(params, length, new_arr)
    chs = input("\n" + " " * 67 + ">| ")
    if chs in [str(el + 1) for el in range(len(new_arr))]:
        chs = int(chs)
        hero[tool] = new_arr[chs - 1]
    elif chs == '0':
        pass
    else:
        alert('wrong input')
        return tool_change(tool)
    



def inventory():
    global hero
    while True:
        clear()
        show_status()
        situation("Chose parameter you want to change")
        params = ['i', 'parameter', 'current status']
        length = [5, 30, 20]
        options = [
            {'i': ' X ', 'parameter': 'sword', 'current status': hero['sword']['power']},
            {'i': ' # ', 'parameter': 'armor', 'current status': hero['armor']['prot']}
        ]
        if hero['shield'] == global_loot['fist']:
            options.append({'i': ' [] ', 'parameter': 'shield', 'current status': hero['sword']['prot']})
        else:
            options.append({'i': ' [] ', 'parameter': 'shield', 'current status': hero['shield']['prot']})
        table(params, length, options)
        chs = input("\n" + " " * 67 + ">| ")
        if chs == '1':
            tool_change('sword')
        elif chs == '2':
            tool_change('armor')
        elif chs == '3':
            tool_change('shield')
        elif chs == '0':
            break
        else:
            alert('wrong input')
            continue

def death():
    global curr_location, hero, last_fire
    clear()
    print('\n' * 7)
    print(you_died)
    enter_to_continue()
    for enemy in enemies:
        enemy['health'] = enemy['init_heal']
    alive_enemies = [el for el in enemies.keys()]
    curr_location = last_fire
    hero['health'] = hero['init_heal']
    return load_location()

def set_location(loc):
    global curr_location, prev_location
    if loc != curr_location:
        prev_location = curr_location
        curr_location = loc
    location_print(loc)   

def load_location():
    clear()
    if curr_location == 'prison room':
        return prison_room()
    elif curr_location == 'room corridor':
        return room_corridor()
    elif curr_location == 'central fire':
        return central_fire()
    elif curr_location == 'central arena':
        return central_arena()
    elif curr_location == 'side corridor':
        return side_corridor()
    elif curr_location == 'second floor':
        return second_floor()
    elif curr_location == 'third floor':
        return third_floor()
    elif curr_location == 'platform':
        return platform()
    else:
        alert("no games found")

def take_rest():
    global alive_enemies, enemies, curr_location, last_fire
    alive_enemies = [el for el in enemies.keys()]
    for enemy in enemies:
        enemy['health'] = enemy['init_heal']
    last_fire = curr_location
    enemy_rebirth()

def drink_estus():
    global hero
    if not hero['estus']:
        message('You have no estus left')
        return 0
    init = hero['init_heal']
    if hero['health'] + 40 < init:
        hero['health'] += 40
    else:
        hero['health'] = init

    hero['estus'] -= 1

def undead_archer_fight(location, next_location):
    global enemies, hero, curr_location
    archer = enemies[location]
    text = ''
    while archer['health'] > 0:
        if hero['health'] <= 0:
            return death()
        clear()
        show_status()
        enemy_stat(archer)

        if text:
            situation(text)
        options = [
            'Rush the enemy',
            'Try to dodge',
            'Get back',
            'Escape',
            'Open inventory'
        ]

        if global_loot['astorian knights shield'] not in hero['inventory'] and curr_location == 'side corridor':
            # if hero haven't taken shield
            options.append('Look to side prison-room')
        if hero['estus']:
            #if hero returned after taking estus
            options.append('Drink estus')

        chs = output(options)
        if chs == 1:
            text = move(archer, 15, 'attack')
        elif chs == 2:
            text = move(archer, 20, 'dodge')
        elif chs == 3:
            return load_location()
        elif chs == 4:
            curr_location = next_location
            return load_location()
        elif chs == 5:
            inventory()
            return undead_archer_fight(location, next_location)
        elif chs == 6 and global_loot['astorian knights shield'] not in hero['inventory']:
            hero = drop({'name': 'astorian knights shield', 'poss': 0})
        elif (chs == 6 and hero['estus']) or (chs == 7 and hero['estus']):
            drink_estus()

    alive_enemies.remove(location)
    hero = drop(
        {'name': 'broken sword', 'poss': 15}, 
        {'name': 'undead soldiers armor', 'poss': 20}, 
        #{'name': 'tower shield', 'poss': 12}
    )
    archer['health'] = archer['init_heal']
    message('You have eliminated enemy')

def undead_swordsman_fight(location, next_location):
    global enemies, hero, curr_location
    swordsman = enemies[location]
    text = ''
    while swordsman['health'] > 0:
        if hero['health'] <= 0:
            return death()
        clear()
        show_status()
        enemy_stat(swordsman)

        if text:
            situation(text)
        options = [
            'Rush the enemy',
            'Try to dodge',
            'Get back',
            'Escape',
            'Open inventory'
        ]

        if hero['estus']:
            #if hero returned after taking estus
            options.append('Drink estus')

        chs = output(options)
        if chs == 1:
            text = move(swordsman, 15, 'attack')
        elif chs == 2:
            text = move(swordsman, 20, 'dodge')
        elif chs == 3:
            return load_location()
        elif chs == 4:
            curr_location = next_location
            return load_location()
        elif chs == 5:
            inventory()
            return undead_swordsman_fight(location, next_location)
        elif chs == 6 and hero['estus']:
            drink_estus()
        else:
            alert('wrong input')
            return undead_swordsman_fight()

    alive_enemies.remove(location)
    hero = drop(
        {'name': 'broken sword', 'poss': 15}, 
        {'name': 'undead soldiers armor', 'poss': 20}, 
        {'name': 'tower shield', 'poss': 12}
    )
    swordsman['health'] = swordsman['init_heal']
    message('You have eliminated enemy')   

def asydemon_fight():
    global enemies
    boss = enemies['asylum demon']
    text = ''
    while boss['health'] > 0:
        if hero['health'] <= 0:
            return death()
        clear()
        show_status()
        enemy_stat(boss)  #show status

        if text:
            situation(text)

        options = [
            'Attack the demon',
            'Try to dodge',
            'Escape to side door',
            'Open backside of central doors'
        ]
        if hero['estus']:
            options.append('Drink estus')

        chs = output(options)
        if chs == 1:
            text = move(boss, 40, 'attack')
        elif chs == 2:
            text = move(boss, 25, 'dodge')
        elif chs == 3:
            return side_corridor()
        elif chs == 4:
            message('door is closed')
        elif hero['estus'] and chs == 5:
            drink_estus()

    boss_defeat()
    key = global_loot['asylum arena key']
    hero['inventory'].append(key)
    message('you`ve got ' + key['name'] + '!')
    enemies['asylum demon'] = None
    alive_enemies.remove('asylum demon')
    return central_arena()

def platform():
    global enemies, hero
    clear()
    show_status()
    set_location('platform')
    if enemies['asylum demon']:
        situation("You see the asylum demon down there")
        options = [
            'Jump on demon',
            'Wait',
            'Get back'
        ]
        chs = output(options)
        if chs == 1:
            boss = enemies['asylum demon']
            boss['health'] -= 100
            return asydemon_fight()
        elif chs == 2:
            message("That wasn't a smart move")
            message("The demon takes you and throw to floor")
            hero['health'] -= 60
            return asydemon_fight()
        else:
            if 'third floor undeads' not in alive_enemies:
                undead_swordsman_fight('third floor undeads', 'second floor')
            return second_floor()
    else:
        situation("You see empty arena")
        output(['Get back'])
        if chs == 1:
            if 'third floor undeads' not in alive_enemies:
                undead_swordsman_fight('third floor undeads', 'second floor')
            if 'steel ball undead' in alive_enemies:
                undead_swordsman_fight('steel ball undead', 'third floor')
            return second_floor()

def third_floor():
    if 'third floor undeads' not in alive_enemies:
        undead_swordsman_fight('third floor undeads', 'platform')
    return platform()

def second_floor():
    global curr_location, hero
    text = ''
    while True:
        clear()
        show_status()
        set_location('second floor')
        if text:
            situation(text)
        options = [
            'Go upper',
            'Go down by stairs',
            'Back to side fire',
        ]
        if curr_location in opened_doors:
            options.append('Look through giant hole')
        if hero['estus']:
            options.append('Drink estus')
        chs = output(options)
        if chs == 1:
            if curr_location not in opened_doors:
                clear()
                show_status()
                situation('You hear strange voices coming upper')
                options = [
                    'Rush',
                    'Get back',
                    'Jump to side',
                ]
                chs = output(options)
                if chs == 1 or chs == 2:
                    text = "That was a giant steel ball, You couldn't dodge it but it has left a big hole on wall"
                    hero['health'] -= 50
                else:
                    text = "That was a giant steel ball, You could dodge it and it has left a big hole on wall"
                opened_doors.append(curr_location)
            else:
                if 'steel ball undead' in alive_enemies:
                    undead_swordsman_fight('steel ball undead', 'third floor')
                    return third_floor()
                else:
                    return third_floor()
        elif chs == 2:
            if 'central fire' not in opened_doors:
                message('You have opened door to central fire')
                opened_doors.append('central fire')
            return central_fire()
        elif chs == 3:
            if 'corridor archer' in alive_enemies:
                undead_archer_fight('corridor archer', 'second floor')
                return side_corridor()
            else:
                return side_corridor()
        elif curr_location in opened_doors and chs == 4 and not hero['estus']:
            clear()
            show_status()
            situation("You see a wounded knight")
            options = [
                "Attack him",
                'Talk to knight',
                'Leave',
            ]
            chs = output(options)
            if chs == 1:
                hero['estus'] = 2
                text = 'You have killed the knight and got estus, estus restores your health'
            elif chs == 2:
                hero['estus'] = 2
                text = ' - I am an astorian knight im damaged so I cant move, take this estus, estus restores your health'
            elif chs == 3:
                continue
        elif curr_location in opened_doors and chs == 4:
            text = 'The knight lies wounding on ground'
        elif chs == 5:
            drink_estus()
        else:
            alert('wrong input')
            return load_location()
                
def side_corridor():
    clear()
    show_status()
    set_location('side corridor')
    print(bonfire)
    options = [
        'Take a rest',
        'Go further by corridor',
        'Return to central arena',
        'Open inventory',
    ]
    chs = output(options)
    if chs == 1:
        take_rest()
        return side_corridor()
    elif chs == 2:
        if 'corridor archer' in alive_enemies:
            undead_archer_fight('corridor archer', 'second floor')
            return second_floor()
        else:
            return second_floor()
    elif chs == 3:
        return central_arena()
    elif chs == 4:
        inventory()
        return side_corridor()
    
def central_arena():
    clear()
    set_location('central arena')
    if enemies['asylum demon']:
        message("here it come flying from the sky")
        print(asylum_demon)
        enter_to_continue()
        return asydemon_fight()
    else:
        clear()
        show_status()
        situation('Empty arena')
        options = [
            'Go to side door',
            'Open backside of central doors',
            "Back to central fire"
        ]
        chs = output(options)
        if chs == 1:
            return side_corridor()
        elif chs == 2:
            message("You see a giant crow which takes you away")
            message("Thank you for playing")
            return main_menu()
        else:
            return central_fire()

def central_fire():
    clear()
    show_status()
    set_location('central fire')
    print(bonfire)
    options = [
        'take a rest',
        'go to side door',
        'go through central gates',
        'go to prison corridor',
        'open inventory'
    ]
    user_chose = output(options)
    if user_chose == 1:
        take_rest()
        return central_fire()
    elif user_chose == 2:
        if curr_location in opened_doors:
            return second_floor()
        else:
            message('door cant be opened from this side')
            return central_fire()
    elif user_chose == 3:
        central_arena()
    elif user_chose == 4:
        return room_corridor()
    elif user_chose == 5:
        inventory()
        return central_fire()

def room_corridor():
    global alive_enemies
    clear()
    set_location('room corridor')
    show_status()
    options = []
    if curr_location in alive_enemies:
        situation("You see 3 undeads staying at wall, they don't attack you")
        options = [
            'Pass them silently',
            'Get back to prison room',
            'Attack them',
        ]
    else:
        situation('you have defeated enemies in corridor')
        options = [
            'Leave corridor',
            'Go to prison room'
        ]
    user_choice = output(options)
    if user_choice == 1:
        return central_fire()
    elif user_choice == 2:
        clear()
        return prison_room()
    elif user_choice == 3 and curr_location in alive_enemies:
        alive_enemies.remove(curr_location)
        hero = drop({'name': 'broken sword', 'poss': 25}, {'name': 'undead soldiers armor', 'poss': 30})
        return room_corridor()

def prison_room():
    clear()
    set_location('prison room')
    options = []
    if not prev_location:
        show_status()
        situation("You wake up in an unknown prison surrounded by cold dark walls sitting somewhere at the corner not to hear terrible sounds coming from outside your room. Suddenly, a dead body falls from top of your room where is a big hole to outside, slowly awaking you look up and you see a leaving knight. А body has a key hanging on the belt, very similar to the one that locked you here")
        options = ['Open prison room door']
    options = ['Go to corridor']

    if global_loot['prison key'] not in hero['inventory']: # if user haven't taken room key
        options.append('Take the key')

    chose = output(options)
    if chose == 1 and global_loot['prison key'] not in hero['inventory']:  # if he tries to open without key
        message('door is locked')
        show_status()
        return prison_room()
    elif chose == 1:    # if key is taken
        if not prev_location:
            message('door opens')
        clear()
        return room_corridor()
    elif chose == 2:    # to take the key
        message("you've got the key")
        hero['inventory'].append(global_loot['prison key'])
        show_status()
        return prison_room()

# functions part

def output(arr):  # output(['hello', 'its me'])

    print(" "*47 + "_"*80)
    for index in range(len(arr)): # for long space
        option = arr[index]
        print()
        print(" "*38 + f"<| {index + 1} |> " + "-" + " "*(40 - len(option)//2) + option + " "*(40 - len(option)//2 - len(option) % 2) + "-" + f" <| {index + 1} |> ")
        print(" "*47 + "_"*80)
    # 0 for back or exit
    print("\n\n" + " "*58 + "<| 0 |> " + "-" + " "*(20 - len('main menu')//2) + 'main menu' + " "*(20 - len('main menu')//2) + "-" + " <| 0 |> ")
    print(" "*67 + "_"*40)
    # input part
    user_choice = input("\n" + " " * 84 + ">| ")
    temp_list = [str(i + 1) for i in range(len(arr))]

    if user_choice == '0':
        return main_menu()
    elif user_choice in temp_list or user_choice == '0': # if this choose exists in list
        return int(user_choice)
    else:
        alert('wrong input')
        show_status()
        return output(arr)

def new_game():
    hero_creator()
    clear()
    return prison_room()

def creator_info():
    clear()
    line = "R A N D O M - J O R D A N"
    print('\n' * 10)
    print('__' * 87 + '\n')
    print(' ' * (87 - len(line) // 2) + line + '\n')
    line = 'https://github.com/random-jordan'
    print(' ' * (87 - len(line) // 2) + line )
    print('__' * 87 + '\n')
    line = 'press enter to continue'
    print(' ' * (87 - len(line) // 2) + line )
    input()
    return main_menu()

def main_menu():
    clear()
    main_menu_options = [
        'continue',
        'new game',
        'credits' 
    ]
    print(logo)
    print(" "*67 + "_"*40)
    for index in range(len(main_menu_options)):
        chose = main_menu_options[index].upper()
        print()
        print(" "*58 + f"<| {index + 1} |> " + "-" + " "*(20 - len(chose)//2) + chose + " "*(20 - len(chose)//2 - len(chose) % 2) + "-" + f" <| {index + 1} |> ")
        print(" "*67 + "_"*40)
    
    print("\n\n" + " "*58 + "<| 0 |> " + "-" + " "*(20 - len('EXIT')//2) + 'EXIT' + " "*(20 - len('EXIT')//2) + "-" + " <| 0 |> ")
    print(" "*67 + "_"*40)
    # input part
    user_choice = input("\n" + " " * 84 + ">| ")
    user_choice = user_choice[0]
    temp_list = [str(i + 1) for i in range(len(main_menu_options))]

    if user_choice not in temp_list and user_choice != '0':
        alert('wrong input')
        return main_menu()
    
    user_choice = int(user_choice)

    if user_choice == 1:
        load_location()
        return main_menu()
    elif user_choice == 2:
        return new_game()
    elif user_choice == 3:
        return creator_info()
    elif user_choice == 0:
        exit()
    else:
        alert('unknown error')
        exit()

def frame():
    string = '|' + ' ' * 178 + '|'
    print('-' * 180 + ('\n' + string) * 19)
    text = 'c o n f i g u r e   t h e   f r a m e'
    print('|' + " "*68 + " "*(19 - len(text)//2) + text.upper() + " "*(19 - len(text)//2) + ' ' * 71 + '|')
    text = 'press enter to continue'
    print('|' + " "*68 + " "*(19 - len(text)//2) + text + " "*(19 - len(text)//2) + ' ' * 71 + '|')
    print((string + '\n') * 19 + '-' * 180)
    input()

frame()
main_menu()  # displaying main menu 